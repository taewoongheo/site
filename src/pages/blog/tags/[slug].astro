---
import HeadingWithLink from "@/components/HeadingWithLink.astro";
import RecentPosts from "@/components/RecentPosts.astro";
import Base from "@/layouts/Base.astro";
import { getCollection } from "astro:content";
import { baseURL } from "@/lib/url";

export async function getStaticPaths() {
  const posts = await getCollection("blog");
  return posts.map((post) => ({
    params: { slug: post.data.tag },
    props: post,
  }));
}

const { slug } = Astro.params;
---

<Base>
  <main class="w-full flex flex-col gap-6">
    <header>
      <HeadingWithLink
        title={`Blog #${slug}`}
        link="see all tags"
        href={`${baseURL}/blog/tags`}
      />
    </header>
    <section aria-label={`Posts tagged with ${slug}`}>
      <RecentPosts tag={slug} />
    </section>
  </main>
</Base>
